# åŸºæœ¬é¢æŸ¥è¯¢ - å¿«é€Ÿå‚è€ƒ

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–
```bash
pip install akshare>=1.10.0
```

### 2. æœ€ç®€å•çš„ä½¿ç”¨æ–¹å¼

```bash
cd /Users/mabelxue/web+/baostock
python app/query_fundamental_simple.py
```

## ğŸ“ ä»£ç ç¤ºä¾‹

### æ–¹å¼1: æ ¹æ®å…¬å¸åç§°æŸ¥è¯¢ï¼ˆæ¨èï¼‰

```python
from src.datasource.akshare_datasource import AkShareDataSource
from src.queries.fundamental_query import FundamentalQuery

company_names = ["è´µå·èŒ…å°", "äº”ç²®æ¶²", "æ³¸å·è€çª–"]

with AkShareDataSource() as datasource:
    query = FundamentalQuery(datasource=datasource)
    df = query.query_by_names(names=company_names, year=2024)
    print(df)
```

### æ–¹å¼2: æ ¹æ®è‚¡ç¥¨ä»£ç æŸ¥è¯¢

```python
from src.datasource.akshare_datasource import AkShareDataSource
from src.queries.fundamental_query import FundamentalQuery

stock_codes = ["600519", "000858", "000568"]

with AkShareDataSource() as datasource:
    query = FundamentalQuery(datasource=datasource)
    results = query.query_multiple(codes=stock_codes, year=2024)
```

### æ–¹å¼3: ç®€åŒ–ç‰ˆæœ¬ï¼ˆä¸ä¾èµ–é¡¹ç›®ç»“æ„ï¼‰

```python
import akshare as ak
import pandas as pd

def query_fundamental(stock_codes, year=2024):
    data = []
    for code in stock_codes:
        df = ak.stock_financial_analysis_indicator(symbol=code)
        if not df.empty and 'æŠ¥å‘ŠæœŸ' in df.columns:
            df = df[df['æŠ¥å‘ŠæœŸ'].str.contains(str(year))]
            if not df.empty:
                data.append(df.iloc[-1])
    return pd.DataFrame(data)

# ä½¿ç”¨
df = query_fundamental(["600519", "000858"])
print(df)
```

## ğŸ“Š è¾“å‡ºæ•°æ®

| å­—æ®µ | è¯´æ˜ |
|------|------|
| è‚¡ç¥¨ä»£ç  | 6ä½ä»£ç  |
| å…¬å¸åç§° | ç®€ç§° |
| æŠ¥å‘ŠæœŸ | è´¢æŠ¥æœŸ |
| å‡€åˆ©æ¶¦ | å‡€åˆ©æ¶¦ |
| å‡€èµ„äº§æ”¶ç›Šç‡ | ROE |
| æ¯›åˆ©ç‡ | æ¯›åˆ©ç‡ |
| èµ„äº§è´Ÿå€ºç‡ | è´Ÿå€ºç‡ |
| æ¯è‚¡æ”¶ç›Š | EPS |

## ğŸ¯ å¸¸ç”¨åœºæ™¯

### åœºæ™¯1: æŸ¥è¯¢ç™½é…’è¡Œä¸š
```python
companies = ["è´µå·èŒ…å°", "äº”ç²®æ¶²", "æ³¸å·è€çª–", "å±±è¥¿æ±¾é…’", "æ´‹æ²³è‚¡ä»½"]
df = query.query_by_names(names=companies, year=2024)
```

### åœºæ™¯2: æŸ¥è¯¢é“¶è¡Œè‚¡
```python
banks = ["600000", "601398", "601288", "601939", "601328"]
results = query.query_multiple(codes=banks, year=2024)
```

### åœºæ™¯3: æŸ¥è¯¢ç§‘æŠ€è‚¡
```python
tech = ["ä¸­å…´é€šè®¯", "çƒ½ç«é€šä¿¡", "ç´«å…‰è‚¡ä»½"]
df = query.query_by_names(names=tech, year=2024)
```

### åœºæ™¯4: å¯¼å‡ºåˆ°CSV
```python
df = query.query_by_names(names=companies, year=2024)
df.to_csv("fundamental_data.csv", index=False, encoding='utf-8-sig')
```

## ğŸ“ é¢„ç½®ç¤ºä¾‹æ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `app/query_fundamental.py` | ç™½é…’è¡Œä¸šç¤ºä¾‹ |
| `app/query_fundamental_custom.py` | å¤šåœºæ™¯ç¤ºä¾‹ |
| `app/query_fundamental_simple.py` | ç®€åŒ–ç‰ˆï¼ˆæ¨èï¼‰ |

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å¿…é¡»ä½¿ç”¨AkShareæ•°æ®æº**ï¼ˆå…è´¹æ— éœ€tokenï¼‰
2. **å…¬å¸åç§°ä½¿ç”¨ç®€ç§°**ï¼ˆå¦‚"è´µå·èŒ…å°"ï¼‰
3. **å»ºè®®æŸ¥è¯¢ä¸Šä¸€å¹´åº¦æ•°æ®**ï¼ˆå½“å¹´æ•°æ®å¯èƒ½æœªå‘å¸ƒï¼‰
4. **ä¸€æ¬¡æŸ¥è¯¢ä¸è¶…è¿‡20å®¶å…¬å¸**ï¼ˆæ€§èƒ½è€ƒè™‘ï¼‰

## ğŸ”§ æ•…éšœæ’é™¤

### é—®é¢˜1: ModuleNotFoundError
```bash
pip install akshare
```

### é—®é¢˜2: æŸ¥è¯¢ç»“æœä¸ºç©º
- æ£€æŸ¥å…¬å¸åç§°æ˜¯å¦æ­£ç¡®
- å°è¯•ä½¿ç”¨è‚¡ç¥¨ä»£ç 
- å°è¯•æŸ¥è¯¢å…¶ä»–å¹´ä»½

### é—®é¢˜3: æµ®ç‚¹å¼‚å¸¸
```bash
pip install --upgrade akshare
# æˆ–ä½¿ç”¨ç®€åŒ–ç‰ˆç¤ºä¾‹
python app/query_fundamental_simple.py
```

## ğŸ“š æ›´å¤šæ–‡æ¡£

- è¯¦ç»†ä½¿ç”¨æŒ‡å—: [åŸºæœ¬é¢æŸ¥è¯¢ä½¿ç”¨æŒ‡å—.md](åŸºæœ¬é¢æŸ¥è¯¢ä½¿ç”¨æŒ‡å—.md)
- åŠŸèƒ½è¯´æ˜: [æ–°å¢åŠŸèƒ½è¯´æ˜.md](æ–°å¢åŠŸèƒ½è¯´æ˜.md)
- é¡¹ç›®README: [README.md](README.md)

## ğŸ’¡ æç¤º

- ä½¿ç”¨ `year=2023` æŸ¥è¯¢2023å¹´æ•°æ®
- ä¸æŒ‡å®šyearå‚æ•°æŸ¥è¯¢å…¨éƒ¨å†å²æ•°æ®
- ä½¿ç”¨ `df.to_csv()` å¯¼å‡ºæ•°æ®
- ä½¿ç”¨ `print(df.columns)` æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å­—æ®µ
